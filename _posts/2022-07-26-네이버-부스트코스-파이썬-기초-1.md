---
title: 인공지능을 위한 파이썬 기초 - 1강. Numerical Python (Numpy)
date: 2022-07-26 21:00:00 +0900
categories: [네이버 부스트코스, 인공지능을 위한 파이썬 기초]
tags: [AI, 네이버 부스트코스, 파이썬, Machine learning]
description: 네이버 부스트코스 - 인공지능을 위한 파이썬 기초 1강
toc: true
toc_sticky: true
toc_label: 목차
math: true
mermaid: true

---

## 간단한 강의 소개
> 이 강의는 네이버 부스트코스의 '인공지능을 위한 파이썬 기초' 강좌입니다. \
> 네이버 AI Tech 4기를 지원하기 위해 기초가 되는 이 수업들을 수강하고 기록해 볼 예정입니다. \
> 기초 파이썬에 대한 내용들을 복습하면서 기초를 되돌아보는 시간으로 활용하고자 합니다.
* [부스트코스 강좌 링크](https://www.boostcourse.org/onlyboostcampaitech4/lecture/1420792)

## Numpy 기본 개념
어떻게 하면, 행렬과 매트릭스를 파이썬 코드로 표현할 수 있을까?

- 파이썬의 고성능 과학 계산용 패키지
- Matrix와 Vector 같은 Array 연산의 사실 상의 표준
- 일반 List에 비해 빠르고, 메모리 효율적
- 반복문 없이 데이터 배열에 대한 처리 가능
- 선형대수와 관련된 다양한 기능 제공

### array creation
```python
import numpy as np

test_array = np.array([1, 4, 5, 8], float) # dtype = float
type(test_array)
type(test_array[3])
```

- numpy는 `np.array` 함수를 통해서 배열을 생성 -> ndarray
- numpy는 하나의 데이터 type만 배열에 넣을 수 있음
- List와 가장 큰 차이점은 Dynamic typing not supported
- shape: numpy array의 dimension 구성 반환
- dtype: numpy array의 데이터 type을 반환

### array shape
- scala: 7
- vector: [10, 10]
- matrix: [[10, 10], [15, 15]]
- 3-tensor: [[[1, 5, 9], [2, 6, 9], [3, 7, 11], [4, 8, 12]]]

### array dtype
```python
import numpy as np

test_array = np.array([1, 4, 5, 8], dtype = np.float32) # Data type을 float으로 선언
```

- ndarray의 single element가 가지는 data type
- 각 element가 차지하는 memory의 크기가 결정됨
- nbytes: ndarray object의 메모리 크기를 반환

## Handling shape

### reshape
```python
import numpy as np

test_matrix = [[1, 2, 3, 4], [1, 2, 5, 8]]
np.array(test_matrix).shape # (2, 4)
np.array(test_matrix).reshape(8, ) # array([1, 2, 3, 4, 1, 2, 5, 8])
np.array(test_matrix).reshape(8, ).shape # (8, )
np.array(test_matrix).reshape(-1, 2).shape # (4, 2)
```

- reshape: element의 개수는 동일한 채로, array의 shape 크기를 변경
- reshape(-1, )에서 `-1` 이라는 것은 size 기반으로 row 개수 선정

### flatten
```python
import numpy as np

test_matrix = [[[1, 2, 3, 4], [1, 2, 5, 8]], [[1, 2, 3, 4], [1, 2, 5, 8]]]
np.array(test_matrix).flatten() # array([1, 2, 3, 4, 1, 2, 5, 8, 1, 2, 3, 4, 1, 2, 5, 8])
np.array(test_matrix).flatten().shape # (16, )
```

- flatten: 다차원 array를 1차원 array로 변환

### indexing & slicing
```python
import numpy as np

## indexing
a = np.array([[1, 2, 3], [4.5, 5, 6]], int)
print(a[0, 0], a[0][0]) # data indexing

a[0, 0] = 12 # data assign
a[0][0] = 5

## slicing
b = np.array([1, 2, 3, 4, 5], [6, 7, 8, 9, 10], int)
b[:, 2:]  # 전체 행 & 2열 이상
b[1, 1:3] # 1행 & 1열~2열
b[1:3]    # 1행~2행 전체
```

- List와 달리 2차원 배열에서 [0, 0]과 같은 표기법을 제공
- matrix의 경우에 앞은 row, 뒤는 column을 의미
- List와 달리 행과 열 부분을 나눠서 slicing 가능
- matrix의 부분 집합을 추출할 때 유용함
- arr[:, ::2] 라는 것은 `start point : end point : steps`

### arange
```python
import numpy as np

np.arange(10) # array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
np.arange(0, 3, 0.5) # array([0, 0.5, 1, 1.5, 2, 2.5, 3])
```

- array의 범위를 지정하여 값의 list를 생성

### ones, zeros, empty
```python
import numpy as np

np.zeros(shape = (5, ), dtype = np.int8) # array([0, 0, 0, 0, 0])
np.zeros((2, 5)) # 2 by 5의 zero matrix 생성
```

- zeros: 0으로 가득찬 ndarray 생성
- ones: 1로 가득찬 ndarray 생성
- empty: shape만 주어지고 비어있는 ndarray 생성 (memory initialization 되지 않음)

### identity, eye, diag
- 단위 행렬 (i 행렬)을 생성 - 대각선이 1인 행렬
- 대각선이 1인 행렬, k값의 시작 index의 변경이 가능 
- 대각 행렬의 값을 추출할 수 있음

### random sampling
```python
import numpy as np

np.random.uniform(0, 1, 10).reshape(2, 5) # 균등분포
np.random.normal(0, 1, 10).reshape(2, 5)  # 정규분포
```

- 데이터 분포에 따른 sampling으로 array를 생성

## Opearion function

### sum, mean, std 등
```python
import numpy as np

test_array = np.arange(1, 11) # array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
test_array.sum(dtype = np.float) # 55.0

```

- ndarray의 element들 간의 sum, mean, std 구하기
- List와 유사하게 동작함

### axis
- 모든 opearion function을 실행할 때 기준이 되는 dimension 축

### concatenate
- numpy array를 붙이는 (합치는) 함수
- `np.vstack, np.hstack, np.concatenate`

## Array operations

### opearions b/t arrays
- numpy는 array 간의 기본적인 사칙 연산을 지원
- array 간의 shape이 같을때 일어나는 연산 (Element-wise opeartion)
- matrix의 기본 연산 (dot 함수 사용 가능)
- 전치 행렬은 transpose로 표현 가능, T attribute 활용 가능
- shape이 다른 배열 간 연산을 지원하는 기능 (broadcasting)

## Numpy performance
- 일반적으로 속도는 for loop < list comprehension < numpy 순서
- 100,000,000 번의 loop가 돈다고 했을 떄, 약 4배 이상의 성능 차이를 보임
- numpy는 C로 구현되었으므로, 성능을 확보하는 대신, dynamic typing을 포기함
- 대용량 계산에서는 가장 흔히 사용됨
- concatenate처럼 계산이 아닌, 할당에서는 연산 속도의 이점이 없음

## Comparisions

### all & any
```python
import numpy as np

test_a = np.array([1, 3, 0], float)
test_a = np.array([5, 2, 1], float)
test_a > test_b # array([False, True, False], dtype = bool)
```

- array의 데이터 전부 (and) 또는 일부 (or)가 조건에 만족 여부 반환
- `np.any(), np.all(), np.logical_and(), np.logical_not(), np.logical_or()` 함수
- numpy는 배열의 크기가 동일할 때, element 간 비교 결과를 Boolean으로 반환

### np.where, np.isnan, np.isfinite
```python
import numpy as np

np.where(a > 0, 3, 2) # array([3, 3, 2]) - where(condition, TRUE, FALSE)
np.where(a > 5)       # index 값 반환
```

### argmax, argmin
- array 내 최댓값 또는 최솟값의 index를 반환
- axis 기반으로 접근 할 수도 있음

## Boolean & Fancy index

### boolean, fancy index
- 특정 조건에 따른 값을 배열 형태로 추출
- comparision operation 함수들도 모두 사용할 수 있음 
- numpy는 array를 index value로 사용해서 값 추출 (matrix도 적용 가능)

## Numpy data I/O

### loadtxt, savetxt
- text type의 데이터를 읽고, 저장할 수도 있음