---
title: 인공지능을 위한 파이썬 기초 - 5강. RNN 첫걸음
date: 2022-07-29 01:00:00 +0900
categories: [네이버 부스트코스, 인공지능을 위한 파이썬 기초]
tags: [AI, 네이버 부스트코스, 파이썬, Machine learning, RNN]
description: 네이버 부스트코스 - 인공지능을 위한 파이썬 기초 5강
toc: true
toc_sticky: true
toc_label: 목차
math: true
mermaid: true

---

* [부스트코스 강좌 링크](https://www.boostcourse.org/onlyboostcampaitech4/lecture/1420702?isDesc=false)

## 시퀀스 데이터 이해하기
- 소리, 문자열, 주가 등의 데이터를 시퀀스 (sequence) 데이터로 분류
- 시계열 (time-series) 데이터는 시간 순서에 따라 나열된 데이터로 시퀀스 데이터에 속함
- 시퀀스 데이터는 순서를 바꾸거나, 과거 정보에 손실이 발생하면 데이터의 확률 분포도 바뀜 (독립동등분포 가정이 위배)
  - 과거 정보 또는 앞뒤 맥락 없이 미래를 예측하거나 문장을 완성하는 것은 불가능함

## 시퀀스 데이터를 다루는 방법
- 이전 시퀀스의 정보를 가지고, 앞으로 발생할 데이터의 확률 분포를 다루기 위해 조건부 확률을 이용할 수 있음
  - 과거에 배웠던 베이즈 법칙을 사용해보자!
  - 조건부 확률은 과거의 모든 정보를 사용하지만, 시퀀스 데이터를 분석할 때 모든 과거 정보가 필요한 것은 아님
- 시퀀스 데이터를 다루기 위해서는 길이가 가변적인 데이터를 다룰 수 있는 모델이 필요함
  - 조건부에 들어가는 데이터 길이는 가변적임
  - 고정된 길이만큼의 시퀀스만 사용하는 경우 자기회귀모델 (Autoregressive Model) 이라고 부름
  - 또 다른 방법은 바로 이전 정보를 제외한 나머지 정보를 잠재변수로 인코딩해서 활용하는 잠재 AR 모델
  - 잠재변수를 신경망을 통해 반복해서 사용하여 시퀀스 데이터의 패턴을 학습하는 모델이 RNN

## Recurrent Neural Network 이해하기
- 가장 기본적인 RNN 모형은 MLP와 유사한 모양
- RNN은 이전 순서의 잠재변수와 현재의 입력을 활용하여 모델링 함
  - 잠재변수를 복제해서 다음 순서의 잠재변수를 인코딩하는데 사용
- RNN의 역전파는 잠재변수의 연결 그래프에 따라 순차적으로 계산
  - Backpropagation Through Time (BPTT) 라고 하고, RNN의 역전파 방법
  - BPTT를 통해 RNN의 가중치 행렬의 미분을 계산해보자

## 기울기 소실 (Gradient vanishing)의 해결책
- 시퀀스 길이가 길어지는 경우 BPTT를 통한 역전파 알고리즘의 계산이 불안정해지므로, 길이를 끊어야 함
  - 이를 truncated BPTT 라고 부르기도 함
- 이런 문제 때문에 Vanilla RNN은 길이가 긴 시퀀스를 처리하는데 문제가 있음
  - 이를 해결하기 위해 등장한 RNN 네트워크가 LSTM과 GRU 임