---
title: 인공지능을 위한 파이썬 기초 - 2강. Panel Data (Pandas)
date: 2022-07-27 01:00:00 +0900
categories: [네이버 부스트코스, 인공지능을 위한 파이썬 기초]
tags: [AI, 네이버 부스트코스, 파이썬, Machine learning]
description: 네이버 부스트코스 - 인공지능을 위한 파이썬 기초 2강
toc: true
toc_sticky: true
toc_label: 목차
math: true
mermaid: true

---

* [부스트코스 강좌 링크](https://www.boostcourse.org/onlyboostcampaitech4/lecture/1420793/?isDesc=false)

## Pandas (Panel data) 기본 개념
- 구조화된 데이터의 처리를 지원하는 파이썬 라이브러리 (파이썬계의 엑셀)
- 고성능 array 계산 라이브러리인 numpy와 통합해서 강력한 스프레드 시트 처리 가능
- 인덱싱, 연산용 함소, 전처리 함수 등을 제공
- 데이터 처리 및 통계 분석을 위해 사용

## Pandas 내의 함수
- Series: 데이터프레임 중 하나의 column에 해당하는 데이터의 모음 object
- DataFrame: 데이터 테이블 전체를 포함하고 있는 object (기본 2차원)

### dataframe indexing and selection 및 기타 함수
- loc: index의 이름
- iloc: indexdml number
- reset_index
- inplace
- drop

```python
df[:3]
df.loc[:, 'account']
df.iloc[2, 1]
df[["account", "name", "street"]]
df.loc[[211829, 320563], ['name', 'street']]
df.drop('city', axis = 1)
```

### lambda, map, apply
- map: pandas의 Series type의 데이터에도 map 함수 사용 가능
- apply: map과 달리, Series 전체에 해당 함수를 적용 가능
  - 입력 값이 Series 데이터로 입력 받아서 handling이 가능
  - 내장 연산 함수를 사용할 때도 똑같은 효과를 얻을 수 있음 (mean, std)
  - scalar 값 외에 Series 값의 반환도 가능
- applymap: Series 단위가 아닌 element 단위로 함수를 적용
  - Series 단위에 apply를 적용시킬 때와 같은 효과


```python
z = {1: 'A', 2: 'B', 3: 'C'}
s1.map(z).head(5)

df['sex_code'] = df.sex.map({'male': 0, 'female': 1})
df.sex.replace({'male': 0, 'female': 1})
```

### pandas build-in functions
- describe: numeric type 데이터의 요약 정보를 보여주기
- unique: Series data의 유일한 값을 list로 반환
- sum: 기본적인 column 또는 row 값의 연산을 지원 (mean, min, max, count ...)
- isnull: column 또는 row 값의 Null 값의 index를 반환
- sort_values: column 값을 기준으로 데이터를 sorting
- correlation, covariance: 상관계수 및 공분산을 구하는 함수

### groupby, aggregateion(agg)
- SQL groupby 명령어와 동일
- split -> apply -> combine 과정을 거쳐서 연산
- 묶음의 기준이 되는 칼럼, 적용 받는 컬럼, 적용 받는 연산

```python
df.groupby('Team')['Points'].sum()
df.groupby(['Team', 'Year'])['Points'].sum()
```

- 추출된 group 정보에는 세 가지 유형의 apply가 가능
- aggregation: 요약된 통계 정보를 추출
- transformation: 해당 정보를 변환해줌
  - aggregation과 달리 key 값 별로 요약된 정보가 아님
  - 개별 데이터의 변환을 지원
- filtration: 특정 정보를 제거하여 보여주는 필터링 기능
  - filter 안에는 boolean 조건이 존재해야 함
  - len(x)는 grouped 된 데이터프레임의 개수

### hierarchical index
- groupby 명령어의 결과물도 결국은 DataFrame
- 두 개의 칼럼으로 groupby를 할 경우, index가 두 개 생성
- group으로 묶여진 데이터를 matrix 형태로 전환해줌 (unstack, reset_index, swaplevel)

### pivot table
- 엑셀에서 봤던 것들
- index 축은 groupby와 동일
- column에 추가로 labeling 값을 추가하여 value에 numeric type 값을 aggregation 하는 형태

### crosstab
- 두 columns에 교차 빈도, 비율, 덧셈 등을 구할 때 사용
- pivot table의 특수한 형태
- user-item rating matrix 등을 만들 때 사용 가능

### merge & concat (join methods)
- merge: SQL에서 많이 사용하는 merge와 같은 기능, 두 개의 데이터를 하나로 합침
- concat: 같은 형태의 데이터를 붙이는 연산 작업

```python
pd.merge(df_a, df_b, left_on = 'subject_id', right_on = 'subject_id')
pd.concat([df_a, df_b], axis = 1)
```

## Database connection
- data loading 시에 DB connection 기능을 제공함

```python
import sqlite3

conn = sqlite3.connect('test.db')
cur = conn.cursor()
cur.execute("SELECT * from airlines limit 5;")
# df_airports = pd.read_sql_query("SELECT * from airports;", conn)
results = cur.fetchall()
results
```

